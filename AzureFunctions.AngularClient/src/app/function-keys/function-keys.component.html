<div class="wrapper" *ngIf="!disabled">
    <busy-state></busy-state>
    <div *ngIf="functionInfo" class="title"> {{'functionKeys_title' | translate}} </div>
    <div *ngIf="!functionInfo" class="title"> {{'adminKeys_title' | translate}} </div>
    <table class="table-function">
        <thead>
            <tr class="not-clickable">
                <th width="15%">{{'functionKeys_keyName' | translate}}</th>
                <th width="50%">{{'functionKeys_keyValue' | translate}}</th>
                <th width="35%" style="text-align: left;">{{'functionKeys_actions' | translate}}</th>
            </tr>
        </thead>
        <tbody>
            <tr class="not-clickable" *ngFor="let key of keys">
                <td>{{key.name}}</td>
                <td *ngIf="key.show">{{key.value}} <a (click)="key.show = false" (keydown)="keyDown($event, 'showKey', key)" class="operation" tabindex="0">{{'functionKeys_clickToHide' | translate}}</a></td>
                <td *ngIf="!key.show"><a (click)="key.show = true" (keydown)="keyDown($event, 'showKey', key)" class="operation" tabindex="0">{{'functionKeys_clickToShow' | translate}}</a></td>
                <td>
                    <div id="operations-bar">
                        <pop-over message="{{ 'copypre_copied' | translate }}" hideAfter="300">
                            <span class="operation" (click)="copyKey(key)" (keydown)="keyDown($event, 'copyKey', key)"><i class="fa fa-copy"></i> {{'functionKeys_copy' | translate}}</span>
                        </pop-over>
                        <a class="operation" (click)="renewKey(key)" (keydown)="keyDown($event, 'renewKey', key)" tabindex="0"><i class="fa fa-refresh"></i> {{'functionKeys_renew' | translate}}</a>
                        <a class="operation" *ngIf="key.name !== '_master'" 
                            (click)="revokeKey(key)" (keydown)="keyDown($event, 'revokeKey', key)" tabindex="0">
                                <i class="fa fa-times"></i> {{'functionKeys_revoke' | translate}}
                        </a>
                    </div>
                </td>
            </tr>
            <tr *ngIf="addingNew" class="not-clickable">
                <td><input type="text" (keyup)="checkValidName($event)" [(ngModel)]="newKeyName" placeholder="{{'functionKeys_enterKeyName' | translate}}" /></td>
                <td><input type="text" (keyup)="checkValidName($event)" [(ngModel)]="newKeyValue" placeholder="{{'functionKeys_enterKeyValue' | translate}}" /></td>
                <td><button class="custom-button" [ngClass]="validKey ? '' : 'disabled'" (click)="saveNewKey()" tabindex="0">{{'save' | translate}}</button></td>
            </tr>
        </tbody>
    </table>
    <button class="custom-button" (click)="showOrHideNewKeyUi()" tabindex="0">
        <span *ngIf="!addingNew && !!functionInfo">
            {{ 'functionKeys_addNewFunctionKey' | translate}}
        </span>
        <span *ngIf="!addingNew && !functionInfo">
            {{ 'functionKeys_addNewAdminKey' | translate}}
        </span>
        <span *ngIf="addingNew">
            {{'functionKeys_discard' | translate}}
        </span>
    </button>
    <!-- workaround custom-button using padding and busy-state not knowing it's height -->
    <div style="height: 10px"></div>
</div>