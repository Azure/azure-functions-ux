<event-hub *ngIf="pickerName === 'EventHub'"
           [functionApp]="functionApp"
           (close)="closePicker($event)"
           (selectItem)="finishDialogPicker($event)">
</event-hub>

<service-bus *ngIf="pickerName === 'ServiceBus'"
             [functionApp]="functionApp"
             (close)="closePicker($event)"
             (selectItem)="finishDialogPicker($event)">
</service-bus>

<app-setting *ngIf="pickerName === 'AppSetting' && input.id !== 'PrincipalId'"
             [functionApp]="functionApp"
             (close)="closePicker($event)"
             (selectItem)="finishDialogPicker($event)">
</app-setting>

<popover-content #pickerPopover
                 placement="auto right"
                 [animation]="true"
                 [closeOnClickOutside]="true">
  <div>
    <span *ngIf="appSettingValue" class="text-label" style="word-wrap: break-word;">{{appSettingValue}}</span>
    <i *ngIf="!appSettingValue" class="fa fa-refresh fa-spin fa-fw margin-bottom"></i>
  </div>
</popover-content>


<!-- http://stackoverflow.com/questions/18499041/bootstrap-3-0-how-to-have-text-and-input-on-same-line -->
<div class="form-group">
  <div class="input-header">
    <label [attr.for]="input?.id" class="control-label">
      {{input?.label}}
      <pop-over [message]="input?.help">
        <span class="glyphicon glyphicon-info-sign"></span>
      </pop-over>
    </label>
    <a *ngIf="input?.type === 'picker'"
          #showValueLink
          [popover]="pickerPopover"
          (onShown)="onAppSettingValueShown()"
          (onHidden)="onAppSettingValueHidden()"
          class="link show-appsetting"
          (keydown)="keyDown($event, 'showValue')"
          tabindex="0">
      {{ 'bindingInput_show' | translate }}
    </a>
  </div>
  <div *ngIf="input?.type === 'string' || input?.type === 'int'" [ngClass]="input?.class">
    <input [fnWriteAccess]="functionApp"
           *ngIf="input.type === 'string'" id="{{input.id}}"
           (ngModelChange)="inputChanged($event)"
           [(ngModel)]="input.value"
           type="text"
           placeholder="{{input.placeholder}}"
           [ngClass]="{'input-error':!!input.errorText}"
           [disabled]="input.isDisabled || !!functionReturnValue"
           tabindex="0">

    <input [fnWriteAccess]="functionApp"
           *ngIf="input.type === 'int'" id="{{input.id}}"
           (ngModelChange)="inputChanged($event)"
           [(ngModel)]="input.value"
           type="text"
           placeholder="{{input.placeholder}}"
           [ngClass]="{'input-error':!!input.errorText}"
           onkeypress='return event.charCode >= 48 && event.charCode <= 57'
           tabindex="0">

    <pop-over *ngIf="!!input.errorText" [message]="input.errorText" [isInputWarning]="true" [isInputError]="!input.isValid">
    </pop-over>

    <div *ngIf="description && !input.errorText">{{description}}</div>

    <div *ngIf="binding.direction.toString() === 'out' && input.id === 'name'">
      <input [fnWriteAccess]="functionApp" 
        id="{{input.id}}" 
        (ngModelChange)="functionReturnValueChanged($event)" 
        [(ngModel)]="functionReturnValue" 
        type="checkbox" 
        style="margin-left:0px;" 
        tabindex="0">
      <label [attr.for]="input.id" class="control-label" style="color: black;">
        {{'binding_useFunctionReturnValue' | translate }}
      </label>
    </div>

  </div>

  <div *ngIf="input?.type === 'picker'" [ngClass]="input?.class">
    <!-- Show drop-down menu of potential app settings -->
    <select id="{{input.id}}"
    [attr.tabindex]="0"
    (ngModelChange)="inputChanged($event)"
    [(ngModel)]="input.value"
    [class.input-error]="!!input.errorText"
    [disabled]="input.isDisabled"
    [class.hide-arrow]="!!input.errorText">
      <option *ngFor="let item of input.items" [value]="item">{{item}}</option>
    </select>
    <pop-over *ngIf="!!input.errorText" [message]="input.errorText" [isInputWarning]="true" [isInputError]="!input.isValid">
    </pop-over>
    <!--[leftOffset]=20 [topOffset]=10-->
    <a *ngIf="!input.inProcess && !showTryView" 
      class="link picker-link" 
      [class.select]="input.errorText" 
      (click)="openPicker(input)" 
      tabindex="0" 
      (keydown)="keyDown($event, 'picker', input)"> 
      {{ 'bindingInput_new' | translate }}
      </a>
    <a *ngIf="!input.inProcess && showTryView" 
      class="button-go-disabled picker-link" 
      [class.select]="input.errorText" 
      [tooltip]="freeAccountTooltip"
      tooltipPlacement="bottom" 
      tabindex="0">
      {{ 'bindingInput_new' | translate }}
    </a>
    <tooltip-content #freeAccountTooltip>
      <p>
        {{ 'tryNow_FreeAccountToolTip' | translate }}
      </p>
    </tooltip-content>
  </div>

  <div *ngIf="input?.type === 'boolean'" class="checkbox">
    <!-- TODO: move this to css -->
    <input 
      id="{{input.id}}" 
      (ngModelChange)="inputChanged($event)" 
      [(ngModel)]="input.value" 
      type="checkbox" 
      style="margin-left:0px" 
      [fnWriteAccess]="functionApp" 
      tabindex="0">
    <div *ngIf="!!input.errorText" class="error-output">{{input.errorText}}</div>
  </div>

  <div *ngIf="input?.type === 'label'">
    <input 
      [fnWriteAccess]="functionApp" 
      id="{{input.id}}" 
      [(ngModel)]="input.value" 
      type="text" 
      placeholder="{{input.text}}" 
      disabled 
      tabindex="0">
    <div *ngIf="!!input.errorText" class="error-output">{{input.errorText}}</div>
  </div>

  <div *ngIf="input?.type === 'enum'" id="enum-list">
    <drop-down [options]="enumInputs" (value)="onDropDownInputChanged($event)" [fnWriteAccess]="functionApp"></drop-down>
    <div *ngIf="!!input.errorText" class="error-output">{{input.errorText}}</div>
  </div>

  <div *ngIf="input?.type === 'checkBoxList'" class="methods-list">
    <div *ngFor="let item of input.enum">
      <input 
        [(ngModel)]="input.value[item.value]" 
        (ngModelChange)="inputChanged($event)" 
        type="checkbox" 
        [fnWriteAccess]="functionApp" 
        tabindex="0" 
        (keydown)="keyDown($event, 'checkbox', input, item)"> 
          {{ item.display }}
    </div>
  </div>

  <div *ngIf="input?.type === 'eventGrid'">
    <binding-event-grid [input]="input"></binding-event-grid>
  </div>

</div>